{
  "version": "1.0",
  "conceptualSchemaSettings": {},
  "queries": [
    {
      "name": "Server",
      "lineageTag": "a6ebe3f5-24a5-461b-b453-30ee89f51a13",
      "queryGroupId": "1f279064-827c-4a5a-9652-af066801fc1b",
      "navigationStepName": "Navigation",
      "text": [
        "\"SCSQLSRV3.sc.pt\\PRD\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Text",
      "isHidden": false
    },
    {
      "name": "Database",
      "lineageTag": "c6a83cf2-1c5b-4dfe-9037-e688b3e67a49",
      "queryGroupId": "1f279064-827c-4a5a-9652-af066801fc1b",
      "navigationStepName": "Navigation",
      "text": [
        "\"BI_CRP\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "DatabaseDim",
      "lineageTag": "e2579bc5-2802-4971-8e67-1159a80b3d10",
      "queryGroupId": "1f279064-827c-4a5a-9652-af066801fc1b",
      "navigationStepName": "Navigation",
      "text": [
        "\"BI_GSC\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Text",
      "isHidden": false
    },
    {
      "name": "MEASURES_TABLE",
      "lineageTag": "96d07bfe-8914-4d3e-934f-b3d98a749ae4",
      "navigationStepName": "Navigation",
      "refreshWhenRefreshingAll": false,
      "text": [
        "let",
        "    Source = \"\"",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = \\\"\\\"\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Text",
      "isHidden": false
    },
    {
      "name": "LastRefresh",
      "lineageTag": "8ffcdd91-ca3b-4bc8-9f0d-5279fb2a3372",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, Database, [Query=\"SELECT GETDATE()\"])",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, Database, [Query=\\\"SELECT GETDATE()\\\"])\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_CALENDAR_WITH_LANG",
      "lineageTag": "4c9e989a-a5be-4453-a7e9-76225fb2be89",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseCalendar),",
        "    PBI_VIEW_GBL_DIM_CALENDAR_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_GBL_DIM_CALENDAR_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_GBL_DIM_CALENDAR_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseCalendar),\\n    PBI_VIEW_GBL_DIM_CALENDAR_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_GBL_DIM_CALENDAR_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_GBL_DIM_CALENDAR_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG",
      "lineageTag": "123c0376-0120-4718-a4f2-ceec8fd1bc57",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_SITES_WITH_LANG",
      "lineageTag": "16ade25a-5a46-44b8-a0b4-2798b54dc53a",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_GBL_DIM_SITES_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_GBL_DIM_SITES_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_GBL_DIM_SITES_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_GBL_DIM_SITES_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_GBL_DIM_SITES_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_GBL_DIM_SITES_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG",
      "lineageTag": "cbe54dce-d9b4-423f-92d8-d365312fc6d5",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG",
      "lineageTag": "2bf853c7-0fe2-4f5e-a238-008d457b6fd3",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_COMPANIES_WITH_LANG",
      "lineageTag": "900bb862-d64c-4534-aa80-545e7ddc985d",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_NLR_DIM_COMPANIES_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_NLR_DIM_COMPANIES_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_NLR_DIM_COMPANIES_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_NLR_DIM_COMPANIES_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_NLR_DIM_COMPANIES_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_NLR_DIM_COMPANIES_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG",
      "lineageTag": "14bf27b3-d24f-4e76-bd6c-7f9947b32b78",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG\"]}[Data]",
        "in",
        "    PBI_VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG\\\"]}[Data]\\nin\\n    PBI_VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_PL_GSC_WITH_LANG",
      "lineageTag": "5af271cf-e524-484d-b58e-7685c15e9f73",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_NLR_DIM_PL_GSC_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_NLR_DIM_PL_GSC_WITH_LANG\"]}[Data],",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(PBI_VIEW_NLR_DIM_PL_GSC_WITH_LANG, \"PL_LEVEL_1_DESC\", \"PL_LEVEL_1_DESC - Cópia\"),",
        "    #\"Colunas com Nome Mudado\" = Table.RenameColumns(#\"Coluna Duplicada\",{{\"PL_LEVEL_1_DESC - Cópia\", \"PL_LEVEL_1_DESC_2\"}})",
        "in",
        "    #\"Colunas com Nome Mudado\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_NLR_DIM_PL_GSC_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_NLR_DIM_PL_GSC_WITH_LANG\\\"]}[Data],\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(PBI_VIEW_NLR_DIM_PL_GSC_WITH_LANG, \\\"PL_LEVEL_1_DESC\\\", \\\"PL_LEVEL_1_DESC - Cópia\\\"),\\n    #\\\"Colunas com Nome Mudado\\\" = Table.RenameColumns(#\\\"Coluna Duplicada\\\",{{\\\"PL_LEVEL_1_DESC - Cópia\\\", \\\"PL_LEVEL_1_DESC_2\\\"}})\\nin\\n    #\\\"Colunas com Nome Mudado\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_FACT_BI_TRANS_PL",
      "lineageTag": "82f64add-fa16-42cc-a16d-ad0ad017e877",
      "queryGroupId": "5aeb940c-989e-4d39-8ce0-df5a22faf236",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, Database, [Query=\"SELECT [SKey_TransPL] AS SKEY_TRANS_PL#(lf)      ,[Client_Id] AS CLIENT_ID#(lf)      ,[DMS_Type_Code] AS DMS_TYPE_CODE#(lf)      ,[NLR_MappingGroup] AS NLR_MAPPING_GROUP#(lf)      ,[Environment] AS ENVIRONMENT#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,[Period] AS PERIOD#(lf)      ,[First_Day] AS FIRST_DAY#(lf)      ,[Last_Day] AS LAST_DAY#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[Site_Type_Code] AS SITE_TYPE_CODE#(lf)      ,[Site_Code] AS SITE_CODE#(lf)      ,[Franchise_Code] AS FRANCHISE_CODE#(lf)      ,[Activity_Code] AS ACTIVITY_CODE#(lf)      ,[Debit] AS DEBIT#(lf)      ,[Credit] AS CREDIT#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Dist_Value] AS DIST_VALUE#(lf)      ,[Dist_Value2] AS DIST_VALUE2#(lf)      ,[Dist_Value3] AS DIST_VALUE3#(lf)      ,[Dist_Value4] AS DIST_VALUE4#(lf)      ,[Dist_Value5] AS DIST_VALUE5#(lf)      ,[Dist_Value6] AS DIST_VALUE6#(lf)      ,[Dist_Value7] AS DIST_VALUE7#(lf)      ,[Dist_Value8] AS DIST_VALUE8#(lf)      ,[Dist_Value9] AS DIST_VALUE9#(lf)      ,[Dist_Value10] AS DIST_VALUE10#(lf)      ,[Dist_Value11] AS DIST_VALUE11#(lf)      ,[Dist_Value12] AS DIST_VALUE12#(lf)      ,[PL_Code] AS PL_CODE#(lf)      ,[PL2_Code] AS PL2_CODE#(lf)      ,[PL_IFRS_Code] AS PL_IFRS_CODE#(lf)      ,[Sales_Type] AS SALES_TYPE#(lf)      ,[Currency_Rate] AS CURRENCY_RATE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)#(lf)FROM [dbo].[NLR_Fact_BI_TransPL] AS FTPL WITH(NOLOCK)\", CreateNavigationProperties=false])",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, Database, [Query=\\\"SELECT [SKey_TransPL] AS SKEY_TRANS_PL#(lf)      ,[Client_Id] AS CLIENT_ID#(lf)      ,[DMS_Type_Code] AS DMS_TYPE_CODE#(lf)      ,[NLR_MappingGroup] AS NLR_MAPPING_GROUP#(lf)      ,[Environment] AS ENVIRONMENT#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,[Period] AS PERIOD#(lf)      ,[First_Day] AS FIRST_DAY#(lf)      ,[Last_Day] AS LAST_DAY#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[Site_Type_Code] AS SITE_TYPE_CODE#(lf)      ,[Site_Code] AS SITE_CODE#(lf)      ,[Franchise_Code] AS FRANCHISE_CODE#(lf)      ,[Activity_Code] AS ACTIVITY_CODE#(lf)      ,[Debit] AS DEBIT#(lf)      ,[Credit] AS CREDIT#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Dist_Value] AS DIST_VALUE#(lf)      ,[Dist_Value2] AS DIST_VALUE2#(lf)      ,[Dist_Value3] AS DIST_VALUE3#(lf)      ,[Dist_Value4] AS DIST_VALUE4#(lf)      ,[Dist_Value5] AS DIST_VALUE5#(lf)      ,[Dist_Value6] AS DIST_VALUE6#(lf)      ,[Dist_Value7] AS DIST_VALUE7#(lf)      ,[Dist_Value8] AS DIST_VALUE8#(lf)      ,[Dist_Value9] AS DIST_VALUE9#(lf)      ,[Dist_Value10] AS DIST_VALUE10#(lf)      ,[Dist_Value11] AS DIST_VALUE11#(lf)      ,[Dist_Value12] AS DIST_VALUE12#(lf)      ,[PL_Code] AS PL_CODE#(lf)      ,[PL2_Code] AS PL2_CODE#(lf)      ,[PL_IFRS_Code] AS PL_IFRS_CODE#(lf)      ,[Sales_Type] AS SALES_TYPE#(lf)      ,[Currency_Rate] AS CURRENCY_RATE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)#(lf)FROM [dbo].[NLR_Fact_BI_TransPL] AS FTPL WITH(NOLOCK)\\\", CreateNavigationProperties=false])\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_PL_GSC_WITH_LANG_BRIDGE",
      "lineageTag": "2a1840b6-e88d-474d-84cb-9cc6d45e3978",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_NLR_DIM_PL_GSC_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"PL_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_NLR_DIM_PL_GSC_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"PL_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG_BRIDGE",
      "lineageTag": "6710716d-0c80-45df-9634-5f3af04ebd81",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"PL_IFRS_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_NLR_DIM_PL_IFRS_SCG_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"PL_IFRS_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_COMPANIES_WITH_LANG_BRIDGE",
      "lineageTag": "c09fce7f-de3c-4114-a7b6-fa411169b8c7",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_NLR_DIM_COMPANIES_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"NLR_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_NLR_DIM_COMPANIES_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"NLR_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG_BRIDGE",
      "lineageTag": "d7e9676c-22f5-4d37-9949-84e55d18831f",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"BL_IFRS_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_NLR_DIM_BL_IFRS_SCG_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"BL_IFRS_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG_BRIDGE",
      "lineageTag": "edad4795-13ef-45f3-8621-2e770aa927e4",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"ACTIVITY_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_NLR_DIM_ACTIVITIES_GSC_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"ACTIVITY_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_SITES_WITH_LANG_BRIDGE",
      "lineageTag": "8798a2bb-a018-4223-bd1a-4d50a59910b1",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_GBL_DIM_SITES_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"SITE_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_GBL_DIM_SITES_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"SITE_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG_BRIDGE",
      "lineageTag": "2c3551af-87d0-4e7a-9879-3c8f38718e7d",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim),",
        "    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG = Source{[Schema=\"PBI\",Item=\"VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG\"]}[Data],",
        "    #\"Removed Other Columns\" = Table.SelectColumns(PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG,{\"FRANCHISE_CODE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim),\\n    PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG = Source{[Schema=\\\"PBI\\\",Item=\\\"VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG\\\"]}[Data],\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(PBI_VIEW_GBL_DIM_FRANCHISES_GSC_WITH_LANG,{\\\"FRANCHISE_CODE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_GBL_DIM_CALENDAR_WITH_LANG_BRIDGE",
      "lineageTag": "010a48bb-f9de-4c45-9a31-147e97016ad5",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = VIEW_GBL_DIM_CALENDAR_WITH_LANG,",
        "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"DATE\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = VIEW_GBL_DIM_CALENDAR_WITH_LANG,\\n    #\\\"Removed Other Columns\\\" = Table.SelectColumns(Source,{\\\"DATE\\\"}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Other Columns\\\")\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_FACT_DW_TRANSBL",
      "lineageTag": "5b60a0a7-5233-4897-b2cf-8a4b255a024e",
      "queryGroupId": "5aeb940c-989e-4d39-8ce0-df5a22faf236",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, Database, [Query=\"SELECT [NLR_Code] AS NLR_CODE#(lf)      ,DATEFROMPARTS(Year, Month, 1) AS BL_DATE#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[Entity_Type] AS ENTITY_TYPE#(lf)      ,[Entity_Account] AS ENTITY_ACCOUNT#(lf)      ,[BL_IFRS_Code_1] AS BL_IFRS_CODE_1#(lf)      ,[BL_IFRS_Signal_1] AS BL_IFRS_SIGNAL_1#(lf)      ,[BL_IFRS_Code_2] AS BL_IFRS_CODE_2#(lf)      ,[BL_IFRS_Signal_2] AS BL_IFRS_SIGNAL_2#(lf)      ,[BL_IFRS_Code_1] AS BL_IFRS_CODE_1#(lf)      ,[BL_IFRS_GroupingAccount] AS BL_IFRS_GROUPING_ACCOUNT#(lf)      ,[BL_IFRS_Record_Type] AS BL_IFRS_RECORD_TYPE#(lf)      ,[Debit] AS DEBIT#(lf)      ,[Credit] AS CREDIT#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[SKey_ControlDiff] AS SKEY_CONTROL_DIFF#(lf)      ,[NLR_PartnerCode] AS NLR_PARTNER_CODE#(lf)FROM [dbo].[NLR_Fact_DW_TransBL] AS FTBL WITH(NOLOCK)\"])",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, Database, [Query=\\\"SELECT [NLR_Code] AS NLR_CODE#(lf)      ,DATEFROMPARTS(Year, Month, 1) AS BL_DATE#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[Entity_Type] AS ENTITY_TYPE#(lf)      ,[Entity_Account] AS ENTITY_ACCOUNT#(lf)      ,[BL_IFRS_Code_1] AS BL_IFRS_CODE_1#(lf)      ,[BL_IFRS_Signal_1] AS BL_IFRS_SIGNAL_1#(lf)      ,[BL_IFRS_Code_2] AS BL_IFRS_CODE_2#(lf)      ,[BL_IFRS_Signal_2] AS BL_IFRS_SIGNAL_2#(lf)      ,[BL_IFRS_Code_1] AS BL_IFRS_CODE_1#(lf)      ,[BL_IFRS_GroupingAccount] AS BL_IFRS_GROUPING_ACCOUNT#(lf)      ,[BL_IFRS_Record_Type] AS BL_IFRS_RECORD_TYPE#(lf)      ,[Debit] AS DEBIT#(lf)      ,[Credit] AS CREDIT#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[SKey_ControlDiff] AS SKEY_CONTROL_DIFF#(lf)      ,[NLR_PartnerCode] AS NLR_PARTNER_CODE#(lf)FROM [dbo].[NLR_Fact_DW_TransBL] AS FTBL WITH(NOLOCK)\\\"])\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_FACT_BI_TRANS_PL_BUDGET",
      "lineageTag": "4e054dc4-8c9c-406d-b170-f7da30b0a9ea",
      "queryGroupId": "5aeb940c-989e-4d39-8ce0-df5a22faf236",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, Database, [Query=\"SELECT [SKey_Id] AS SKEY_ID#(lf)      ,[Client_Id] AS CLIENT_ID#(lf)      ,[NLR_MappingGroup] AS NLR_MAPPING_GROUP#(lf)      ,[Environment] AS ENVIRONMENT#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,DATEFROMPARTS(LEFT(Period,4),RIGHT(Period,2),1) AS PERIOD#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[Cost_Centre] AS COST_CENTRE#(lf)      ,[Cost_Centre_Desc] AS COST_CENTRE_DESC#(lf)      ,[Site_Code] AS SITE_CODE#(lf)      ,[Franchise_Code] AS FRANCHISE_CODE#(lf)      ,[Activity_Code] AS ACTIVITY_CODE#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Dist_Value] AS DIST_VALUE#(lf)      ,[Dist_Value2] AS DIST_VALUE2#(lf)      ,[Dist_Value3] AS DIST_VALUE3#(lf)      ,[Dist_Value4] AS DIST_VALUE4#(lf)      ,[PL_Code] AS PL_CODE#(lf)      ,[PL_IFRS_Code] AS PL_IFRS_CODE#(lf)      ,[Sales_Type_Code] AS SALES_TYPE_CODE#(lf)      ,[Currency_Rate] AS CURRENCY_RATE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[Value_Type_Code] AS VALUE_TYPE_CODE#(lf)FROM [dbo].[NLR_Fact_BI_TransPL_Budget] AS FTPLBUD WITH(NOLOCK)\"])",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, Database, [Query=\\\"SELECT [SKey_Id] AS SKEY_ID#(lf)      ,[Client_Id] AS CLIENT_ID#(lf)      ,[NLR_MappingGroup] AS NLR_MAPPING_GROUP#(lf)      ,[Environment] AS ENVIRONMENT#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,DATEFROMPARTS(LEFT(Period,4),RIGHT(Period,2),1) AS PERIOD#(lf)      ,[NLR_Account] AS NLR_ACCOUNT#(lf)      ,[NLR_Account_Desc] AS NLR_ACCOUNT_DESC#(lf)      ,[Cost_Centre] AS COST_CENTRE#(lf)      ,[Cost_Centre_Desc] AS COST_CENTRE_DESC#(lf)      ,[Site_Code] AS SITE_CODE#(lf)      ,[Franchise_Code] AS FRANCHISE_CODE#(lf)      ,[Activity_Code] AS ACTIVITY_CODE#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Dist_Value] AS DIST_VALUE#(lf)      ,[Dist_Value2] AS DIST_VALUE2#(lf)      ,[Dist_Value3] AS DIST_VALUE3#(lf)      ,[Dist_Value4] AS DIST_VALUE4#(lf)      ,[PL_Code] AS PL_CODE#(lf)      ,[PL_IFRS_Code] AS PL_IFRS_CODE#(lf)      ,[Sales_Type_Code] AS SALES_TYPE_CODE#(lf)      ,[Currency_Rate] AS CURRENCY_RATE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[Value_Type_Code] AS VALUE_TYPE_CODE#(lf)FROM [dbo].[NLR_Fact_BI_TransPL_Budget] AS FTPLBUD WITH(NOLOCK)\\\"])\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "VIEW_NLR_FACT_BI_BL_BUDGET",
      "lineageTag": "44cb29c3-8833-46ad-ac33-d9dcdaa785a1",
      "queryGroupId": "5aeb940c-989e-4d39-8ce0-df5a22faf236",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, Database, [Query=\"SELECT [Client_Id] AS CLIENT_ID#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,[CSN_Entity_Code] AS CSN_ENTITY_CODE#(lf)      ,DATEFROMPARTS(LEFT(BL_Month,4), RIGHT(BL_Month,2),1) AS ANALYSIS_DATE#(lf)      ,[Value_Type_Code] AS VALUE_TYPE_CODE#(lf)      ,[BL_IFRS_Code] AS BL_IFRS_CODE#(lf)      ,[BL_IFRS_Signal] AS BL_IFRS_SIGNAL#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[SKey_Id] AS SKEY_ID#(lf)#(tab)  ,[Currency_Rate] AS CURRENCY_RATE#(lf)#(lf)FROM [dbo].[NLR_Fact_BI_BL_Budget] AS FTBLBUD WITH(NOLOCK)\"])",
        "in",
        "    Source"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, Database, [Query=\\\"SELECT [Client_Id] AS CLIENT_ID#(lf)      ,[NLR_Code] AS NLR_CODE#(lf)      ,[CSN_Entity_Code] AS CSN_ENTITY_CODE#(lf)      ,DATEFROMPARTS(LEFT(BL_Month,4), RIGHT(BL_Month,2),1) AS ANALYSIS_DATE#(lf)      ,[Value_Type_Code] AS VALUE_TYPE_CODE#(lf)      ,[BL_IFRS_Code] AS BL_IFRS_CODE#(lf)      ,[BL_IFRS_Signal] AS BL_IFRS_SIGNAL#(lf)      ,[Balance] AS BALANCE#(lf)      ,[Record_Date] AS RECORD_DATE#(lf)      ,[SKey_Id] AS SKEY_ID#(lf)#(tab)  ,[Currency_Rate] AS CURRENCY_RATE#(lf)#(lf)FROM [dbo].[NLR_Fact_BI_BL_Budget] AS FTBLBUD WITH(NOLOCK)\\\"])\\nin\\n    Source\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "SIGNAL",
      "lineageTag": "cc153f0f-a94b-4fb0-a10b-00909e76078d",
      "queryGroupId": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Database(Server, DatabaseDim, [Query=\"-- Código para desmultiplicar a Dim PL com as rúbricas fontes para cálculo das categorias calculadas.#(lf)#(lf)  #(lf)#(tab)DECLARE @ExecOrder_Counter SMALLINT#(lf)#(tab)#(tab),@Execution_Order SMALLINT#(lf)#(lf)  #(tab)SELECT @ExecOrder_Counter = MAX(Execution_Order)#(lf)#(tab)FROM NLR_MapBI_PL_CalcCategories_GSC#(lf)#(lf)#(lf)#(tab)--Vamos criar uma tabela temporária para tratar este processo#(lf)#(tab)IF OBJECT_ID('tempdb..#temp_CalculatedTest') IS NOT NULL DROP TABLE #temp_CalculatedTest#(lf)#(lf)#(tab)CREATE TABLE #temp_CalculatedTest#(lf)#(tab)(#(lf)#(tab)#(tab)[PL_Code_Calculated] [varchar](20) COLLATE Latin1_General_CI_AS NULL,#(lf)#(tab)#(tab)[PL_Code_Source] [varchar](20) NULL,#(lf)#(tab)#(tab)[PL_Signal] [smallint] NULL#(lf)#(tab))#(lf)#(lf)#(tab)SET @Execution_Order = 1#(lf)#(tab)-- #(lf)#(tab)WHILE (@Execution_Order <= @ExecOrder_Counter)#(lf)#(tab)BEGIN#(lf)#(tab)#(tab)#(tab)INSERT INTO #temp_CalculatedTest#(lf)#(tab)#(tab)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Calculated_Test.PL_Code_Source, CASE WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END,'') AS PL_Code_Source#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Calculated_Test.PL_Signal, Calc.PL_Signal, 1) AS PL_Signal#(lf)#(tab)#(tab)#(tab)FROM [dbo].[NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN [dbo].[NLR_MapBI_PL_CalcCategories_GSC] AS Calc ON Dim.PL_Code like Calc.PL_Code_Destin + '%'#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN #temp_CalculatedTest AS Calculated_Test ON Calculated_Test.PL_Code_Calculated like #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)CASE #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) AND (LEN(Calc.PL_Code_Source) = '3' AND LEN(Calc.PL_Code_Destin) = '3') THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END +'%'#(lf)#(tab)#(tab)#(tab)WHERE Dim.IsCalculated = 1#(lf)#(tab)#(tab)#(tab)#(tab)AND Calc.Execution_Order = @Execution_Order#(lf)#(tab)#(tab)#(tab)UNION#(lf)#(tab)#(tab)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Dim2.PL_Code, #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)CASE WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)END,'') AS PL_Code_Source#(lf)#(tab)#(tab)#(tab)#(tab), Calc.PL_Signal AS PL_Signal#(tab)#(lf)#(tab)#(tab)#(tab)FROM [dbo].[NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)#(tab)#(tab)INNER JOIN [dbo].[NLR_MapBI_PL_CalcCategories_GSC] AS Calc ON Dim.PL_Code like Calc.PL_Code_Destin + '%'#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN [dbo].[NLR_Dim_PL_GSC] AS Dim2 ON Dim2.PL_Code like #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)CASE #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) AND (LEN(Calc.PL_Code_Source) = '3' AND LEN(Calc.PL_Code_Destin) = '3') THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END +'%'#(lf)#(tab)#(tab)#(tab)#(tab)AND Dim2.IsCalculated = 0#(lf)#(tab)#(tab)#(tab)#(tab)AND Dim2.Info_Flag = 0#(lf)#(tab)#(tab)#(tab)WHERE Dim.IsCalculated = 1#(lf)#(tab)#(tab)#(tab)#(tab)AND Calc.Execution_Order = @Execution_Order#(lf)#(lf)#(lf)#(tab)#(tab)#(tab)SET @Execution_Order = @Execution_Order + 1#(lf)#(tab)END#(lf)#(lf)#(lf)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab), Dim.PL_Level_1_Code#(lf)#(tab)#(tab), Dim.PL_Level_2_Code#(lf)#(tab)#(tab), Dim.PL_Level_3_Code#(lf)#(tab)#(tab), Dim.PL_Level_4_Code#(lf)#(tab)#(tab), Dim.PL_Level_5_Code#(lf)#(tab)#(tab), Dim.PT_PL_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_1_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_2_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_3_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_4_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_5_Desc#(lf)#(tab)#(tab), CASE WHEN Dim.IsCalculated = 1 THEN Calc_Test.PL_Code_Source#(lf)#(tab)#(tab)#(tab)ELSE NULL END AS PL_Code_Source_ForCalculation#(lf)#(tab)#(tab), CASE WHEN Dim.IsCalculated = 1 THEN Calc_Test.PL_Signal#(lf)#(tab)#(tab)#(tab)ELSE 1 END AS PL_Code_Source_Signal_ForCalculations#(lf)#(tab)FROM [NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)LEFT OUTER JOIN #temp_CalculatedTest AS Calc_Test ON Dim.PL_Code = Calc_Test.PL_Code_Calculated#(lf)#(tab)ORDER BY Dim.PL_Display_Order#(lf)\"]),",
        "    #\"Added Conditional Column\" = Table.AddColumn(Source, \"PL_CACULATION\", each if [PL_Code_Source_ForCalculation] = null then [PL_Code] else [PL_Code_Source_ForCalculation])",
        "in",
        "    #\"Added Conditional Column\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Database(Server, DatabaseDim, [Query=\\\"-- Código para desmultiplicar a Dim PL com as rúbricas fontes para cálculo das categorias calculadas.#(lf)#(lf)  #(lf)#(tab)DECLARE @ExecOrder_Counter SMALLINT#(lf)#(tab)#(tab),@Execution_Order SMALLINT#(lf)#(lf)  #(tab)SELECT @ExecOrder_Counter = MAX(Execution_Order)#(lf)#(tab)FROM NLR_MapBI_PL_CalcCategories_GSC#(lf)#(lf)#(lf)#(tab)--Vamos criar uma tabela temporária para tratar este processo#(lf)#(tab)IF OBJECT_ID('tempdb..#temp_CalculatedTest') IS NOT NULL DROP TABLE #temp_CalculatedTest#(lf)#(lf)#(tab)CREATE TABLE #temp_CalculatedTest#(lf)#(tab)(#(lf)#(tab)#(tab)[PL_Code_Calculated] [varchar](20) COLLATE Latin1_General_CI_AS NULL,#(lf)#(tab)#(tab)[PL_Code_Source] [varchar](20) NULL,#(lf)#(tab)#(tab)[PL_Signal] [smallint] NULL#(lf)#(tab))#(lf)#(lf)#(tab)SET @Execution_Order = 1#(lf)#(tab)-- #(lf)#(tab)WHILE (@Execution_Order <= @ExecOrder_Counter)#(lf)#(tab)BEGIN#(lf)#(tab)#(tab)#(tab)INSERT INTO #temp_CalculatedTest#(lf)#(tab)#(tab)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Calculated_Test.PL_Code_Source, CASE WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END,'') AS PL_Code_Source#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Calculated_Test.PL_Signal, Calc.PL_Signal, 1) AS PL_Signal#(lf)#(tab)#(tab)#(tab)FROM [dbo].[NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN [dbo].[NLR_MapBI_PL_CalcCategories_GSC] AS Calc ON Dim.PL_Code like Calc.PL_Code_Destin + '%'#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN #temp_CalculatedTest AS Calculated_Test ON Calculated_Test.PL_Code_Calculated like #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)CASE #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) AND (LEN(Calc.PL_Code_Source) = '3' AND LEN(Calc.PL_Code_Destin) = '3') THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END +'%'#(lf)#(tab)#(tab)#(tab)WHERE Dim.IsCalculated = 1#(lf)#(tab)#(tab)#(tab)#(tab)AND Calc.Execution_Order = @Execution_Order#(lf)#(tab)#(tab)#(tab)UNION#(lf)#(tab)#(tab)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab)#(tab)#(tab), COALESCE(Dim2.PL_Code, #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)CASE WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)END,'') AS PL_Code_Source#(lf)#(tab)#(tab)#(tab)#(tab), Calc.PL_Signal AS PL_Signal#(tab)#(lf)#(tab)#(tab)#(tab)FROM [dbo].[NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)#(tab)#(tab)INNER JOIN [dbo].[NLR_MapBI_PL_CalcCategories_GSC] AS Calc ON Dim.PL_Code like Calc.PL_Code_Destin + '%'#(lf)#(tab)#(tab)#(tab)LEFT OUTER JOIN [dbo].[NLR_Dim_PL_GSC] AS Dim2 ON Dim2.PL_Code like #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)CASE #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)WHEN LEN(Calc.PL_Code_Source) <> LEN(Dim.PL_Code) AND (LEN(Calc.PL_Code_Source) = '3' AND LEN(Calc.PL_Code_Destin) = '3') THEN Calc.PL_Code_Source + SUBSTRING(Dim.PL_Code, LEN(Calc.PL_Code_Source) + 1, LEN(Dim.PL_Code) - LEN(Calc.PL_Code_Source))#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)ELSE Calc.PL_Code_Source END +'%'#(lf)#(tab)#(tab)#(tab)#(tab)AND Dim2.IsCalculated = 0#(lf)#(tab)#(tab)#(tab)#(tab)AND Dim2.Info_Flag = 0#(lf)#(tab)#(tab)#(tab)WHERE Dim.IsCalculated = 1#(lf)#(tab)#(tab)#(tab)#(tab)AND Calc.Execution_Order = @Execution_Order#(lf)#(lf)#(lf)#(tab)#(tab)#(tab)SET @Execution_Order = @Execution_Order + 1#(lf)#(tab)END#(lf)#(lf)#(lf)#(tab)SELECT Dim.PL_Code#(lf)#(tab)#(tab), Dim.PL_Level_1_Code#(lf)#(tab)#(tab), Dim.PL_Level_2_Code#(lf)#(tab)#(tab), Dim.PL_Level_3_Code#(lf)#(tab)#(tab), Dim.PL_Level_4_Code#(lf)#(tab)#(tab), Dim.PL_Level_5_Code#(lf)#(tab)#(tab), Dim.PT_PL_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_1_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_2_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_3_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_4_Desc#(lf)#(tab)#(tab), Dim.PT_PL_Level_5_Desc#(lf)#(tab)#(tab), CASE WHEN Dim.IsCalculated = 1 THEN Calc_Test.PL_Code_Source#(lf)#(tab)#(tab)#(tab)ELSE NULL END AS PL_Code_Source_ForCalculation#(lf)#(tab)#(tab), CASE WHEN Dim.IsCalculated = 1 THEN Calc_Test.PL_Signal#(lf)#(tab)#(tab)#(tab)ELSE 1 END AS PL_Code_Source_Signal_ForCalculations#(lf)#(tab)FROM [NLR_Dim_PL_GSC] AS Dim#(lf)#(tab)LEFT OUTER JOIN #temp_CalculatedTest AS Calc_Test ON Dim.PL_Code = Calc_Test.PL_Code_Calculated#(lf)#(tab)ORDER BY Dim.PL_Display_Order#(lf)\\\"]),\\n    #\\\"Added Conditional Column\\\" = Table.AddColumn(Source, \\\"PL_CACULATION\\\", each if [PL_Code_Source_ForCalculation] = null then [PL_Code] else [PL_Code_Source_ForCalculation])\\nin\\n    #\\\"Added Conditional Column\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "DatabaseCalendar",
      "lineageTag": "9ad37941-05ed-4d82-9384-49e8d3ea33f5",
      "queryGroupId": "1f279064-827c-4a5a-9652-af066801fc1b",
      "navigationStepName": "Navigation",
      "text": [
        "\"BI_GSC\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Text",
      "isHidden": false
    }
  ],
  "queryGroups": [
    {
      "name": "Parameters",
      "id": "1f279064-827c-4a5a-9652-af066801fc1b",
      "description": ""
    },
    {
      "name": "Dimensions",
      "id": "c534ec67-f93f-48b1-ae5b-55466cc574dd",
      "order": 1,
      "description": ""
    },
    {
      "name": "Facts",
      "id": "5aeb940c-989e-4d39-8ce0-df5a22faf236",
      "order": 2,
      "description": ""
    }
  ],
  "culture": "pt-PT",
  "firewallEnabled": true
}